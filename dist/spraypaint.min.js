!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.spraypaint={})}(this,function(t){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function u(t,e){function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var n=function(){return(n=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};function e(t,e,r,i){var n,s=arguments.length,o=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,r,i);else for(var a=t.length-1;0<=a;a--)(n=t[a])&&(o=(s<3?n(o):3<s?n(e,r,o):n(e,r))||o);return 3<s&&o&&Object.defineProperty(e,r,o),o}function o(t,o,a,u){return new(a=a||Promise)(function(r,e){function i(t){try{s(u.next(t))}catch(t){e(t)}}function n(t){try{s(u.throw(t))}catch(t){e(t)}}function s(t){var e;t.done?r(t.value):((e=t.value)instanceof a?e:new a(function(t){t(e)})).then(i,n)}s((u=u.apply(t,o||[])).next())})}function l(r,i){var n,s,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,s&&(o=2&e[0]?s.return:e[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,e[1])).done)return o;switch(s=0,o&&(e=[2&e[0],o.value]),e[0]){case 0:case 1:o=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,s=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(o=0<(o=a.trys).length&&o[o.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!o||e[1]>o[0]&&e[1]<o[3])){a.label=e[1];break}if(6===e[0]&&a.label<o[1]){a.label=o[1],o=e;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(e);break}o[2]&&a.ops.pop(),a.trys.pop();continue}e=i.call(r,a)}catch(t){e=[6,t],s=0}finally{n=o=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var s=(r.apply=function(t,e){new r(t,e).apply()},r.prototype.apply=function(){var i=this,n={};this.payload.errors&&(this.payload.errors.forEach(function(t){var e=t.meta;if(!e)throw new Error("invalid json");var r=e.relationship;r?i._processRelationship(i.model,r,t):i._processResource(n,e,t)}),this.model.errors=n)},r.prototype._processResource=function(t,e,r){var i=this.model.klass.deserializeKey(e.attribute);t[i]={title:r.title,code:r.code,attribute:e.attribute,message:e.message,fullMessage:"base"===i?e.message:r.detail,rawPayload:r}},r.prototype._processRelationship=function(t,e,r){var i,n,s=t[t.klass.deserializeKey(e.name)];Array.isArray(s)&&(s=s.find(function(t){return t.id&&String(t.id)===String(e.id)||t.temp_id&&t.temp_id===e["temp-id"]})),e.relationship?this._processRelationship(s,e.relationship,r):(i={},this._processResource(i,e,r),n={},Object.keys(s.errors).forEach(function(t){n[t]=s.errors[t]}),Object.keys(i).forEach(function(t){var e=i[t];void 0!==e&&(n[t]=e)}),s.errors=n)},r);function r(t,e){this.model=t,this.payload=e}function a(t,e){var r=e.headers.get("X-JWT");r&&t.setJWT(r)}function c(t,e){if(h()){var r=p[t];return"["+r[0]+"m"+e+"["+r[1]+"m"}return e}var p={green:[32,39],cyan:[36,39],magenta:[35,39],bold:[1,22]},h=function(){return!1},f=(d.prototype.get=function(t,e){return e.method="GET",this._fetchWithLogging(t,e)},d.prototype.post=function(t,e,r){return r.method="POST",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},d.prototype.patch=function(t,e,r){return this.config.patchAsPost?(r.method="POST",r.headers||(r.headers={}),r.headers["X-HTTP-Method-Override"]="PATCH"):r.method="PATCH",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},d.prototype.delete=function(t,e){return e.method="DELETE",this._fetchWithLogging(t,e)},d.prototype._logRequest=function(t,e){this.logger.info(c("cyan",t+": ")+c("magenta",e))},d.prototype._logResponse=function(t){this.logger.debug(c("bold",JSON.stringify(t,null,4)))},d.prototype._fetchWithLogging=function(r,i){return o(this,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:return this._logRequest(i.method||"UNDEFINED METHOD",r),[4,this._fetch(r,i)];case 1:return e=t.sent(),this._logResponse(e.jsonPayload),[2,e]}})})},d.prototype._fetch=function(n,s){return o(this,void 0,void 0,function(){var e,r,i;return l(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,this.middleware.beforeFetch(n,s)];case 1:return t.sent(),[3,3];case 2:throw e=t.sent(),new v("beforeFetch failed; review middleware.beforeFetch stack",n,s,e);case 3:return t.trys.push([3,5,,6]),[4,fetch(n,s)];case 4:return r=t.sent(),[3,6];case 5:throw i=t.sent(),new _(null,i.message,i);case 6:return[4,this._handleResponse(r,s)];case 7:return t.sent(),[2,r]}})})},d.prototype._handleResponse=function(n,s){return o(this,void 0,void 0,function(){var e,r,i;return l(this,function(t){switch(t.label){case 0:if("DELETE"===s.method&&-1<[204,200].indexOf(n.status))return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.clone().json()];case 2:return e=t.sent(),[3,4];case 3:if(r=t.sent(),-1<[202,204].indexOf(n.status))return[2];throw new _(n,"invalid json",r);case 4:return t.trys.push([4,6,,7]),[4,this.middleware.afterFetch(n,e)];case 5:return t.sent(),[3,7];case 6:throw i=t.sent(),new _(n,"afterFetch failed; review middleware.afterFetch stack",i);case 7:if(500<=n.status)throw new _(n,"Server Error");if(422!==n.status&&void 0===e.data)throw 404===n.status?new _(n,"record not found"):new _(n,"invalid json");return n.jsonPayload=e,[2]}})})},d);function d(t,e,r){this.middleware=t,this.logger=e,this.config=Object.assign({patchAsPost:!1},r)}var y,v=(u(b,y=Error),b);function b(t,e,r,i){var n=y.call(this,t)||this;return n.stack=i.stack,n.url=e,n.options=r,n.originalError=i,n}var g,_=(u(m,g=Error),m);function m(t,e,r){var i=g.call(this,e||"Invalid Response")||this;return i.response=t,i.originalError=r,i}var j=(w.prototype.toScopeObject=function(){var t={};for(var e in this.dct)this.dct.hasOwnProperty(e)&&(t[e]=this.dct[e].toScopeObject());return t},w.prototype.toString=function(){var i=[],n=this;for(var t in this.dct)!function(e){var t,r;n.dct.hasOwnProperty(e)&&(""===(t=n.dct[e].toString())?i.push(e):(r=(r=t.split(",")).map(function(t){return e+"."+t}),i.push(r.join(","))))}(t);return i.join(",")},w.prototype._parseIncludeArgs=function(t){if(Array.isArray(t))return this._parseArray(t);if("string"!=typeof t)return"object"==typeof t?this._parseObject(t):{};var e={};return e[t]={},e},w.prototype._parseObject=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=this._parseIncludeArgs(t[r]));return e},w.prototype._parseArray=function(t){for(var e={},r=0,i=t;r<i.length;r++){var n=i[r],s=this._parseIncludeArgs(n);for(var o in s)s.hasOwnProperty(o)&&(e[o]=s[o])}return e},w);function w(t){this.dct={};var e=this._parseIncludeArgs(t);for(var r in e)e.hasOwnProperty(r)&&(this.dct[r]=new w(e[r]))}var k=0,O=function(){return"temp-id-"+ ++k},A=(P.prototype.attributes=function(){var n=this,s={};return this._eachAttribute(function(t,e,r){var i;n.model.isPersisted&&!n.model.changes()[t]||(i=n.model.klass.serializeKey(t),r.type===Number&&""===e?s[i]=null:s[i]=e)}),s},P.prototype.removeDeletions=function(s,o){var a=this;Object.keys(o).forEach(function(r){var t,i=o[r],n=s,e=n[r];e&&(Array.isArray(e)?e.forEach(function(t,e){t.isMarkedForDestruction||t.isMarkedForDisassociation?n[r].splice(e,1):a.removeDeletions(t,i)}):(t=e).isMarkedForDestruction||t.isMarkedForDisassociation?n[r]=null:a.removeDeletions(t,i))})},P.prototype.postProcess=function(){this.removeDeletions(this.model,this.includeDirective),this.model.resetRelationTracking(this.includeDirective)},P.prototype.relationships=function(){var s=this,o={};return Object.keys(this.includeDirective).forEach(function(e){var r,i=s.includeDirective[e],n=!1;-1<e.indexOf(".")&&(e=e.split(".")[0],n=!0);var t=s.model[e];t&&(Array.isArray(t)?(r=[],t.forEach(function(t){!s._isNewAndMarkedForDestruction(t)&&(n||s.model.hasDirtyRelation(e,t)||t.isDirty(i))&&r.push(s._processRelatedModel(t,i,n))}),0===r.length&&(r=null)):!s._isNewAndMarkedForDestruction(t)&&(n||s.model.hasDirtyRelation(e,t)||t.isDirty(i))&&(r=s._processRelatedModel(t,i,n)),r&&(o[s.model.klass.serializeKey(e)]={data:r}))}),o},P.prototype.asJSON=function(){var t,e={type:this.jsonapiType};this.model.id&&(e.id=this.model.id),this.model.temp_id&&(e["temp-id"]=this.model.temp_id),this.idOnly||(t=this.attributes(),0<Object.keys(t).length&&(e.attributes=t));var r=this.relationships();0<Object.keys(r).length&&(e.relationships=r);var i={data:e};return 0<this.included.length&&(i.included=this.included),i},P.prototype._isNewAndMarkedForDestruction=function(t){return!t.isPersisted&&t.isMarkedForDestruction},P.prototype._processRelatedModel=function(e,t,r){var i=this;e.clearErrors(),e.isPersisted||(e.temp_id=O());var n=new P(e,t,r),s=n.asJSON().data;return this._isNewAndMarkedForDestruction(e)||this._pushInclude(s),n.included.forEach(function(t){i._isNewAndMarkedForDestruction(e)||i._pushInclude(t)}),this._resourceIdentifierFor(e)},P.prototype._resourceIdentifierFor=function(t){if(!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType for model "+t);var e,r={type:t.klass.jsonapiType};return t.id&&(r.id=t.id),t.temp_id&&(r["temp-id"]=t.temp_id),e=t.isPersisted?t.isMarkedForDestruction?"destroy":t.isMarkedForDisassociation?"disassociate":"update":"create",r.method=e,r},P.prototype._pushInclude=function(t){this._isIncluded(t)||this.included.push(t)},P.prototype._isIncluded=function(e){return this.included.forEach(function(t){if(t.type===e.type&&(t.id===e.id||t["temp-id"]===e["temp-id"]))return!0}),!1},P.prototype._eachAttribute=function(i){var n=this,s=this.model.typedAttributes;Object.keys(s).forEach(function(t){var e,r=n.model.klass.attributeList[t];r.persist&&(e=s[t],i(t,e,r))})},P);function P(t,e,r){void 0===r&&(r=!1),this.included=[],this.idOnly=!1;var i=new j(e);if(this.includeDirective=i.toScopeObject(),this.model=t,this.idOnly=r,!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType");this.jsonapiType=t.klass.jsonapiType}var C,S=($.prototype.getItem=function(t){return this._data[t]||null},$.prototype.setItem=function(t,e){this._data[t]=e},$.prototype.removeItem=function(t){delete this._data[t]},$);function $(){this._data={}}try{C=localStorage}catch(t){C=new S}var R=(Object.defineProperty(E.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),E.prototype.getJWT=function(){return this._backend.getItem(this._jwtKey)||void 0},E.prototype.setJWT=function(t){t?this._backend.setItem(this._jwtKey,t):this._backend.removeItem(this._jwtKey)},E);function E(t,e){void 0===e&&(e=C),this._jwtKey=t,this._backend=e}function x(t,e){return t===e||t!=t&&e!=e}function F(t,e){for(var r=t.length;r--;)if(x(t[r][0],e))return r;return-1}var T=Array.prototype.splice;function D(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}D.prototype.clear=function(){this.__data__=[],this.size=0},D.prototype.delete=function(t){var e=this.__data__,r=F(e,t);return!(r<0)&&(r==e.length-1?e.pop():T.call(e,r,1),--this.size,!0)},D.prototype.get=function(t){var e=this.__data__,r=F(e,t);return r<0?void 0:e[r][1]},D.prototype.has=function(t){return-1<F(this.__data__,t)},D.prototype.set=function(t,e){var r=this.__data__,i=F(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this};var z="object"==typeof global&&global&&global.Object===Object&&global,I="object"==typeof self&&self&&self.Object===Object&&self,L=z||I||Function("return this")(),M=L.Symbol,U=Object.prototype,N=U.hasOwnProperty,B=U.toString,J=M?M.toStringTag:void 0;var K=Object.prototype.toString;var W="[object Null]",H="[object Undefined]",G=M?M.toStringTag:void 0;function Z(t){return null==t?void 0===t?H:W:G&&G in Object(t)?function(t){var e=N.call(t,J),r=t[J];try{var i=!(t[J]=void 0)}catch(t){}var n=B.call(t);return i&&(e?t[J]=r:delete t[J]),n}(t):(e=t,K.call(e));var e}function q(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var V="[object AsyncFunction]",Q="[object Function]",Y="[object GeneratorFunction]",X="[object Proxy]";function tt(t){if(q(t)){var e=Z(t);return e==Q||e==Y||e==V||e==X}}var et,rt=L["__core-js_shared__"],it=(et=/[^.]+$/.exec(rt&&rt.keys&&rt.keys.IE_PROTO||""))?"Symbol(src)_1."+et:"";var nt=Function.prototype.toString;function st(t){if(null!=t){try{return nt.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var ot=/^\[object .+?Constructor\]$/,at=Function.prototype,ut=Object.prototype,ct=at.toString,lt=ut.hasOwnProperty,pt=RegExp("^"+ct.call(lt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ht(t){var e;return q(t)&&(e=t,!(it&&it in e))&&(tt(t)?pt:ot).test(st(t))}function ft(t,e){var r,i,n=(i=e,null==(r=t)?void 0:r[i]);return ht(n)?n:void 0}var dt=ft(L,"Map"),yt=ft(Object,"create");var vt=Object.prototype.hasOwnProperty;var bt=Object.prototype.hasOwnProperty;function gt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}function _t(t,e){var r,i,n=t.__data__;return("string"==(i=typeof(r=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof e?"string":"hash"]:n.map}function mt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}gt.prototype.clear=function(){this.__data__=yt?yt(null):{},this.size=0},gt.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},gt.prototype.get=function(t){var e=this.__data__;if(yt){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return vt.call(e,t)?e[t]:void 0},gt.prototype.has=function(t){var e=this.__data__;return yt?void 0!==e[t]:bt.call(e,t)},gt.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=yt&&void 0===e?"__lodash_hash_undefined__":e,this},mt.prototype.clear=function(){this.size=0,this.__data__={hash:new gt,map:new(dt||D),string:new gt}},mt.prototype.delete=function(t){var e=_t(this,t).delete(t);return this.size-=e?1:0,e},mt.prototype.get=function(t){return _t(this,t).get(t)},mt.prototype.has=function(t){return _t(this,t).has(t)},mt.prototype.set=function(t,e){var r=_t(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this};function jt(t){var e=this.__data__=new D(t);this.size=e.size}jt.prototype.clear=function(){this.__data__=new D,this.size=0},jt.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},jt.prototype.get=function(t){return this.__data__.get(t)},jt.prototype.has=function(t){return this.__data__.has(t)},jt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof D){var i=r.__data__;if(!dt||i.length<199)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new mt(i)}return r.set(t,e),this.size=r.size,this};var wt=function(){try{var t=ft(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function kt(t,e,r){"__proto__"==e&&wt?wt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Ot=Object.prototype.hasOwnProperty;function At(t,e,r){var i=t[e];Ot.call(t,e)&&x(i,r)&&(void 0!==r||e in t)||kt(t,e,r)}function Pt(t,e,r,i){var n=!r;r=r||{};for(var s=-1,o=e.length;++s<o;){var a=e[s],u=i?i(r[a],t[a],a,r,t):void 0;void 0===u&&(u=t[a]),(n?kt:At)(r,a,u)}return r}function Ct(t){return null!=t&&"object"==typeof t}function St(t){return Ct(t)&&"[object Arguments]"==Z(t)}var $t=Object.prototype,Rt=$t.hasOwnProperty,Et=$t.propertyIsEnumerable,xt=St(function(){return arguments}())?St:function(t){return Ct(t)&&Rt.call(t,"callee")&&!Et.call(t,"callee")},Ft=Array.isArray;var Tt="object"==typeof t&&t&&!t.nodeType&&t,Dt=Tt&&"object"==typeof module&&module&&!module.nodeType&&module,zt=Dt&&Dt.exports===Tt?L.Buffer:void 0,It=(zt?zt.isBuffer:void 0)||function(){return!1},Lt=9007199254740991,Mt=/^(?:0|[1-9]\d*)$/;var Ut=9007199254740991;function Nt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Ut}var Bt={};function Jt(e){return function(t){return e(t)}}Bt["[object Float32Array]"]=Bt["[object Float64Array]"]=Bt["[object Int8Array]"]=Bt["[object Int16Array]"]=Bt["[object Int32Array]"]=Bt["[object Uint8Array]"]=Bt["[object Uint8ClampedArray]"]=Bt["[object Uint16Array]"]=Bt["[object Uint32Array]"]=!0,Bt["[object Arguments]"]=Bt["[object Array]"]=Bt["[object ArrayBuffer]"]=Bt["[object Boolean]"]=Bt["[object DataView]"]=Bt["[object Date]"]=Bt["[object Error]"]=Bt["[object Function]"]=Bt["[object Map]"]=Bt["[object Number]"]=Bt["[object Object]"]=Bt["[object RegExp]"]=Bt["[object Set]"]=Bt["[object String]"]=Bt["[object WeakMap]"]=!1;var Kt="object"==typeof t&&t&&!t.nodeType&&t,Wt=Kt&&"object"==typeof module&&module&&!module.nodeType&&module,Ht=Wt&&Wt.exports===Kt&&z.process,Gt=function(){try{var t=Wt&&Wt.require&&Wt.require("util").types;return t?t:Ht&&Ht.binding&&Ht.binding("util")}catch(t){}}(),Zt=Gt&&Gt.isTypedArray,qt=Zt?Jt(Zt):function(t){return Ct(t)&&Nt(t.length)&&!!Bt[Z(t)]},Vt=Object.prototype.hasOwnProperty;function Qt(t,e){var r,i,n,s=Ft(t),o=!s&&xt(t),a=!s&&!o&&It(t),u=!s&&!o&&!a&&qt(t),c=s||o||a||u,l=c?function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}(t.length,String):[],p=l.length;for(var h in t)!e&&!Vt.call(t,h)||c&&("length"==h||a&&("offset"==h||"parent"==h)||u&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||(n=void 0,n=typeof(r=h),(i=null==(i=p)?Lt:i)&&("number"==n||"symbol"!=n&&Mt.test(r))&&-1<r&&r%1==0&&r<i))||l.push(h);return l}var Yt=Object.prototype;function Xt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Yt)}function te(e,r){return function(t){return e(r(t))}}var ee=te(Object.keys,Object),re=Object.prototype.hasOwnProperty;function ie(t){if(!Xt(t))return ee(t);var e=[];for(var r in Object(t))re.call(t,r)&&"constructor"!=r&&e.push(r);return e}function ne(t){return null!=t&&Nt(t.length)&&!tt(t)}function se(t){return(ne(t)?Qt:ie)(t)}var oe=Object.prototype.hasOwnProperty;function ae(t){if(!q(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Xt(t),r=[];for(var i in t)("constructor"!=i||!e&&oe.call(t,i))&&r.push(i);return r}function ue(t){return ne(t)?Qt(t,!0):ae(t)}var ce="object"==typeof t&&t&&!t.nodeType&&t,le=ce&&"object"==typeof module&&module&&!module.nodeType&&module,pe=le&&le.exports===ce?L.Buffer:void 0,he=pe?pe.allocUnsafe:void 0;function fe(){return[]}var de=Object.prototype.propertyIsEnumerable,ye=Object.getOwnPropertySymbols,ve=ye?function(e){return null==e?[]:(e=Object(e),function(t,e){for(var r=-1,i=null==t?0:t.length,n=0,s=[];++r<i;){var o=t[r];e(o,r,t)&&(s[n++]=o)}return s}(ye(e),function(t){return de.call(e,t)}))}:fe;function be(t,e){for(var r=-1,i=e.length,n=t.length;++r<i;)t[n+r]=e[r];return t}var ge=te(Object.getPrototypeOf,Object),_e=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)be(e,ve(t)),t=ge(t);return e}:fe;function me(t,e,r){var i=e(t);return Ft(t)?i:be(i,r(t))}function je(t){return me(t,se,ve)}function we(t){return me(t,ue,_e)}var ke=ft(L,"DataView"),Oe=ft(L,"Promise"),Ae=ft(L,"Set"),Pe=ft(L,"WeakMap"),Ce="[object Map]",Se="[object Promise]",$e="[object Set]",Re="[object WeakMap]",Ee="[object DataView]",xe=st(ke),Fe=st(dt),Te=st(Oe),De=st(Ae),ze=st(Pe),Ie=Z;(ke&&Ie(new ke(new ArrayBuffer(1)))!=Ee||dt&&Ie(new dt)!=Ce||Oe&&Ie(Oe.resolve())!=Se||Ae&&Ie(new Ae)!=$e||Pe&&Ie(new Pe)!=Re)&&(Ie=function(t){var e=Z(t),r="[object Object]"==e?t.constructor:void 0,i=r?st(r):"";if(i)switch(i){case xe:return Ee;case Fe:return Ce;case Te:return Se;case De:return $e;case ze:return Re}return e});var Le=Ie,Me=Object.prototype.hasOwnProperty;var Ue=L.Uint8Array;function Ne(t){var e=new t.constructor(t.byteLength);return new Ue(e).set(new Ue(t)),e}var Be=/\w*$/;var Je=M?M.prototype:void 0,Ke=Je?Je.valueOf:void 0;var We="[object Boolean]",He="[object Date]",Ge="[object Map]",Ze="[object Number]",qe="[object RegExp]",Ve="[object Set]",Qe="[object String]",Ye="[object Symbol]",Xe="[object ArrayBuffer]",tr="[object DataView]",er="[object Float32Array]",rr="[object Float64Array]",ir="[object Int8Array]",nr="[object Int16Array]",sr="[object Int32Array]",or="[object Uint8Array]",ar="[object Uint8ClampedArray]",ur="[object Uint16Array]",cr="[object Uint32Array]";function lr(t,e,r){var i,n,s,o,a,u,c,l=t.constructor;switch(e){case Xe:return Ne(t);case We:case He:return new l(+t);case tr:return u=t,c=r?Ne(u.buffer):u.buffer,new u.constructor(c,u.byteOffset,u.byteLength);case er:case rr:case ir:case nr:case sr:case or:case ar:case ur:case cr:return o=t,a=r?Ne(o.buffer):o.buffer,new o.constructor(a,o.byteOffset,o.length);case Ge:return new l;case Ze:case Qe:return new l(t);case qe:return(s=new(n=t).constructor(n.source,Be.exec(n))).lastIndex=n.lastIndex,s;case Ve:return new l;case Ye:return i=t,Ke?Object(Ke.call(i)):{}}}var pr=Object.create,hr=function(t){if(!q(t))return{};if(pr)return pr(t);fr.prototype=t;var e=new fr;return fr.prototype=void 0,e};function fr(){}var dr=Gt&&Gt.isMap,yr=dr?Jt(dr):function(t){return Ct(t)&&"[object Map]"==Le(t)};var vr=Gt&&Gt.isSet,br=vr?Jt(vr):function(t){return Ct(t)&&"[object Set]"==Le(t)},gr=1,_r=2,mr=4,jr="[object Arguments]",wr="[object Function]",kr="[object GeneratorFunction]",Or="[object Object]",Ar={};function Pr(r,i,n,t,e,s){var o,a=i&gr,u=i&_r,c=i&mr;if(n&&(o=e?n(r,t,e,s):n(r)),void 0!==o)return o;if(!q(r))return r;var l,p,h,f,d,y,v,b,g,_,m,j,w=Ft(r);if(w){if(m=(_=r).length,j=new _.constructor(m),m&&"string"==typeof _[0]&&Me.call(_,"index")&&(j.index=_.index,j.input=_.input),o=j,!a)return function(t,e){var r=-1,i=t.length;for(e=e||Array(i);++r<i;)e[r]=t[r];return e}(r,o)}else{var k=Le(r),O=k==wr||k==kr;if(It(r))return function(t,e){if(e)return t.slice();var r=t.length,i=he?he(r):new t.constructor(r);return t.copy(i),i}(r,a);if(k==Or||k==jr||O&&!e){if(o=u||O?{}:"function"!=typeof(g=r).constructor||Xt(g)?{}:hr(ge(g)),!a)return u?(b=d=r,y=(v=o)&&Pt(b,ue(b),v),Pt(d,_e(d),y)):(f=l=r,p=(h=o)&&Pt(f,se(f),h),Pt(l,ve(l),p))}else{if(!Ar[k])return e?r:{};o=lr(r,k,a)}}var A=(s=s||new jt).get(r);if(A)return A;s.set(r,o),br(r)?r.forEach(function(t){o.add(Pr(t,i,n,t,r,s))}):yr(r)&&r.forEach(function(t,e){o.set(e,Pr(t,i,n,e,r,s))});var P=c?u?we:je:u?keysIn:se,C=w?void 0:P(r);return function(t,e){for(var r=-1,i=null==t?0:t.length;++r<i&&!1!==e(t[r],r,t););}(C||r,function(t,e){C&&(t=r[e=t]),At(o,e,Pr(t,i,n,e,r,s))}),o}Ar[jr]=Ar["[object Array]"]=Ar["[object ArrayBuffer]"]=Ar["[object DataView]"]=Ar["[object Boolean]"]=Ar["[object Date]"]=Ar["[object Float32Array]"]=Ar["[object Float64Array]"]=Ar["[object Int8Array]"]=Ar["[object Int16Array]"]=Ar["[object Int32Array]"]=Ar["[object Map]"]=Ar["[object Number]"]=Ar[Or]=Ar["[object RegExp]"]=Ar["[object Set]"]=Ar["[object String]"]=Ar["[object Symbol]"]=Ar["[object Uint8Array]"]=Ar["[object Uint8ClampedArray]"]=Ar["[object Uint16Array]"]=Ar["[object Uint32Array]"]=!0,Ar["[object Error]"]=Ar[wr]=Ar["[object WeakMap]"]=!1;var Cr=1,Sr=4;function $r(t){return Pr(t,Cr|Sr)}var Rr,Er=(function(t){var e;t.exports=(e={},(e=function(){this.listeners={}}).prototype={addEventListener:function(t,e,r){for(var i=[],n=arguments.length,s=0;s<n;s++)i.push(arguments[s]);i=3<i.length?i.splice(3,i.length-1):[],void 0!==this.listeners[t]?this.listeners[t].push({scope:r,callback:e,args:i}):this.listeners[t]=[{scope:r,callback:e,args:i}]},removeEventListener:function(t,e,r){if(void 0!==this.listeners[t]){for(var i=this.listeners[t].length,n=[],s=0;s<i;s++){var o=this.listeners[t][s];o.scope==r&&o.callback==e||n.push(o)}this.listeners[t]=n}},hasEventListener:function(t,e,r){if(void 0!==this.listeners[t]){var i=this.listeners[t].length;if(void 0===e&&void 0===r)return 0<i;for(var n=0;n<i;n++){var s=this.listeners[t][n];if((!r||s.scope==r)&&s.callback==e)return!0}}return!1},dispatch:function(t,e){for(var r={type:t,target:e},i=[],n=arguments.length,s=0;s<n;s++)i.push(arguments[s]);if(i=2<i.length?i.splice(2,i.length-1):[],i=[r].concat(i),void 0!==this.listeners[t])for(var o=this.listeners[t].slice(),a=o.length,s=0;s<a;s++){var u,c=o[s];c&&c.callback&&(u=i.concat(c.args),c.callback.apply(c.scope,u))}},getEvents:function(){var t="";for(var e in this.listeners)for(var r=this.listeners[e].length,i=0;i<r;i++){var n=this.listeners[e][i];t+=n.scope&&n.scope.className?n.scope.className:"anonymous",t+=" listen for '"+e+"'\n"}return t}},new e)}(Rr={exports:{}}),Rr.exports),xr=Object.freeze({default:Er,__moduleExports:Er}),Fr=(Object.defineProperty(Tr.prototype,"count",{get:function(){return Object.keys(this.data).length},enumerable:!0,configurable:!0}),Tr.prototype.find=function(t,e){return void 0===e&&(e=null),e=e||t.storeKey,this.data[e]},Tr.prototype.findAll=function(t){var r=this,i=[];return t.forEach(function(t){var e=r.find(t);e&&i.push(e)}),i},Tr.prototype.create=function(t,e){t.storeKey=e,t.stale=!1,this.data[e]=$r(t.attributes)},Tr.prototype.updateOrCreate=function(t){var e;t.storeKey?this.create(t,t.storeKey):(e=this.keyFor(t),this.create(t,e)),xr.dispatch(t.storeKey,{},this.data[t.storeKey])},Tr.prototype.destroy=function(t){t.stale=!0,delete this.data[t.storeKey]},Tr.prototype.keyFor=function(t){return t.klass.jsonapiType+"-"+t.id},Tr);function Tr(){this.data={}}var Dr=(zr.prototype.addResources=function(t){if(t)if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var i=r[e];this._resources.push(i)}else this._resources.push(t)},zr.prototype.instanceFor=function(t){var e=this.registry.get(t);if(!e)throw new Error('Unknown type "'+t+'"');return new e},zr.prototype.relationshipInstanceFor=function(e,t){return t.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e["temp-id"]&&t.temp_id===e["temp-id"]))})||this.instanceFor(e.type)},zr.prototype.lookupAssociated=function(t,e){return t.find(function(t){return!(t.klass.jsonapiType!==e.klass.jsonapiType||!(t.temp_id&&e.temp_id&&t.temp_id===e.temp_id||t.id&&e.id&&t.id===e.id))})},zr.prototype.pushRelation=function(t,e,r){var i=t,n=i[e];this.lookupAssociated(n,r)||i[e].push(r)},zr.prototype.deserialize=function(t){var e=this.instanceFor(t.type);return this.deserializeInstance(e,t,{})},zr.prototype.deserializeInstance=function(t,e,r){void 0===r&&(r={});var i=this.alreadyDeserialized(e);return i||(t.id=e.id,t.temp_id=e["temp-id"],t.assignAttributes(e.attributes),t.assignLinks(e.links),t.setMeta(e.meta),this._deserialized.push(t),this._processRelationships(t,e.relationships||{},r),this._removeDeletions(t,r),t.isPersisted=!0,t.reset(),t)},zr.prototype._removeDeletions=function(n,s){var o=this;Object.keys(s).forEach(function(r){var t,i=n,e=i[r];e&&(Array.isArray(e)?e.forEach(function(t,e){t.isMarkedForDestruction?i.klass.store.destroy(t):t.isMarkedForDisassociation?i[r].splice(e,1):o._removeDeletions(t,s[r]||{})}):(t=e).isMarkedForDestruction?i.klass.store.destroy(t):t.isMarkedForDisassociation?i[r]=null:o._removeDeletions(t,s[r]||{}))})},zr.prototype._processRelationships=function(h,t,f){var d=this;this._iterateValidRelationships(h,t,function(t,e){var r=f[t],i=h;if(Array.isArray(e))for(var n=0,s=e;n<s.length;n++){var o=s[n],a=d.findResource(o),u=i[t],c=d.relationshipInstanceFor(a,u),c=d.deserializeInstance(c,a,r);d.pushRelation(h,t,c)}else{var a=d.findResource(e),l=i[t],p=l||d.instanceFor(a.type),p=d.deserializeInstance(p,a,r);l||(i[t]=p)}})},zr.prototype._iterateValidRelationships=function(t,e,r){for(var i in e)if(e.hasOwnProperty(i)){var n=t.klass.deserializeKey(i);if(t.klass.attributeList[n]){var s=e[i].data;if(!s)continue;r(n,s)}}},zr.prototype.alreadyDeserialized=function(e){return this._deserialized.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e.temp_id&&t.temp_id===e["temp-id"]))})},zr.prototype.findResource=function(e){return this._resources.find(function(t){return!(t.type!==e.type||!(t.id&&e.id&&t.id===e.id||t["temp-id"]&&e["temp-id"]&&t["temp-id"]===e["temp-id"]))})||e},zr);function zr(t,e){this._deserialized=[],this._resources=[],this.registry=t,this.payload=e,this.addResources(e.data),this.addResources(e.included)}var Ir=Object.prototype.hasOwnProperty;var Lr=(Mr.prototype.checkRelation=function(t,e){var r=!1;return e.isPersisted&&((this.model._originalRelationships[t]||[]).find(function(t){return JSON.stringify(t)===JSON.stringify(e.resourceIdentifier)})||(r=!0)),r},Mr.prototype.check=function(t){void 0===t&&(t={});var e=new j(t).toScopeObject();return this._hasDirtyAttributes()||this._hasDirtyRelationships(e)||this.model.isMarkedForDestruction||this.model.isMarkedForDisassociation||this._isUnpersisted()},Mr.prototype.dirtyAttributes=function(){for(var t={},e=0,r=Object.keys(this.model.attributes);e<r.length;e++){var i=r[e],n=this.model._originalAttributes[i],s=this.model.attributes[i],o=this.model.klass.attributeList[i];this.model.isPersisted?o.dirtyChecker(n,s)&&(t[i]=[n,s]):t[i]=[null,s]}return t},Mr.prototype._isUnpersisted=function(){return!this.model.isPersisted&&JSON.stringify(this.model.attributes)!==JSON.stringify({})},Mr.prototype._hasDirtyAttributes=function(){return!function(t){if(null==t)return 1;if(ne(t)&&(Ft(t)||"string"==typeof t||"function"==typeof t.splice||It(t)||qt(t)||xt(t)))return!t.length;var e=Le(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(Xt(t))return!ie(t).length;for(var r in t)if(Ir.call(t,r))return;return 1}(this.dirtyAttributes())},Mr.prototype._hasDirtyRelationships=function(t){var i=this,n=!1;return this._eachRelatedObject(t,function(t,e,r){e.isDirty(r)&&(n=!0),i.checkRelation(t,e)&&(n=!0)}),n},Mr.prototype._eachRelatedObject=function(i,n){var s=this;Object.keys(i).forEach(function(e){var r=i[e],t=s.model[e];Array.isArray(t)||(t=[t]),t.forEach(function(t){t&&n(e,t,r)})})},Mr);function Mr(t){this.model=t}var Ur=function(t,e){var r,i=[];for(var n in t){!t.hasOwnProperty(n)||null!=(r=t[n])&&""!==r&&(e&&(n=e+"["+n+"]"),Array.isArray(r)?0<(r=r.map(function(t){return Nr(t)})).length&&i.push(n+"="+r.join(",")):"object"==typeof r?i.push(Ur(r,n)):i.push(n+"="+Nr(r)))}return(i=i.filter(function(t){return!!t})).join("&")},Nr=function(t){var e="undefined"!=typeof window,r=e&&window.navigator.userAgent.match(/(MSIE|Trident)/),i="string"==typeof t&&-1!==t.indexOf("%");return e&&r&&!i?encodeURIComponent(t):t},Br=(Object.defineProperty(Jr.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,"data",{get:function(){return this._collection},enumerable:!0,configurable:!0}),Object.defineProperty(Jr.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),Jr);function Jr(t,e){void 0===e&&(e={data:[]}),this._collection=t,this._raw_json=e}var Kr=(Object.defineProperty(Wr.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(Wr.prototype,"data",{get:function(){return this._record},enumerable:!0,configurable:!0}),Object.defineProperty(Wr.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),Wr);function Wr(t,e){this._record=t,this._raw_json=e}var Hr=(Object.defineProperty(Gr.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(Gr.prototype,"data",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(Gr.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),Gr);function Gr(t){this._raw_json=t}var Zr=(qr.prototype.all=function(){return o(this,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url())];case 1:return e=t.sent(),[2,this._buildCollectionResult(e)]}})})},qr.prototype.find=function(r){return o(this,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url(r))];case 1:return e=t.sent(),[2,this._buildRecordResult(e)]}})})},qr.prototype.first=function(){return o(this,void 0,void 0,function(){var e,r;return l(this,function(t){switch(t.label){case 0:return[4,(e=this.per(1))._fetch(e.model.url())];case 1:return r=t.sent(),[2,this._buildRecordResult(r)]}})})},qr.prototype.merge=function(r){var i=this,n=this.copy();return Object.keys(r).forEach(function(t){var e=i.model.serializeKey(t);n._associations[e]=r[t]}),n},qr.prototype.page=function(t){var e=this.copy();return e._pagination.number=t,e},qr.prototype.per=function(t){var e=this.copy();return e._pagination.size=t,e},qr.prototype.where=function(t){var e=this.copy();for(var r in t=this._serverCasedWhereClause(t))t.hasOwnProperty(r)&&(e._filter[r]=t[r]);return e},qr.prototype.extraParams=function(t){var e=this.copy();for(var r in t)t.hasOwnProperty(r)&&(e._extraParams[r]=t[r]);return e},qr.prototype.stats=function(t){var e=this.copy();for(var r in t=this._serverCasedStatsClause(t))t.hasOwnProperty(r)&&(e._stats[r]=t[r]);return e},qr.prototype.order=function(t){var e=this.copy();if("object"==typeof(t=this._serverCasedOrderClause(t)))for(var r in t)t.hasOwnProperty(r)&&(e._sort[r]=t[r]);else e._sort[t]="asc";return e},qr.prototype.select=function(t){var e=this.copy();if(t=this._serverCasedFieldsClause(t),Array.isArray(t)){var r=this.model.jsonapiType;e._fields[r]=t}else for(var i in t)t.hasOwnProperty(i)&&(e._fields[i]=t[i]);return e},qr.prototype.selectExtra=function(t){var e=this.copy();if(t=this._serverCasedFieldsClause(t),Array.isArray(t)){var r=this.model.jsonapiType;e._extra_fields[r]=t}else for(var i in t)t.hasOwnProperty(i)&&(e._extra_fields[i]=t[i]);return e},qr.prototype.includes=function(t){var e=this.copy();t=this._serverCasedIncludesClause(t);var r=new j(t).toScopeObject();for(var i in r)r.hasOwnProperty(i)&&(e._include[i]=r[i]);return e},qr.prototype.extraFetchOptions=function(t){var e=this.copy();for(var r in t)t.hasOwnProperty(r)&&(e._extraFetchOptions[r]=t[r]);return e},qr.prototype.scope=function(){return this},qr.prototype.asQueryParams=function(){var e=this,r={page:this._pagination,filter:this._filter,sort:this._sortParam(this._sort)||[],fields:this._fields,extra_fields:this._extra_fields,stats:this._stats,include:new j(this._include).toString()};return this._mergeAssociationQueryParams(r,this._associations),Object.keys(this._extraParams).forEach(function(t){r[t]=e._extraParams[t]}),r},qr.prototype.toQueryParams=function(){var t=Ur(this.asQueryParams());if(""!==t)return t},qr.prototype.fetchOptions=function(){return n({},this.model.fetchOptions(),this._extraFetchOptions)},qr.prototype.copy=function(){return $r(this)},qr.prototype._mergeAssociationQueryParams=function(i,e){var n=this;for(var t in e)!function(r){var t;e.hasOwnProperty(r)&&(t=e[r].asQueryParams(),i.page[r]=t.page,i.filter[r]=t.filter,i.stats[r]=t.stats,Object.assign(i.fields,t.fields),Object.assign(i.extra_fields,t.extra_fields),t.sort.forEach(function(t){var e=n._transformAssociationSortParam(r,t);i.sort.push(e)}))}(t)},qr.prototype._transformAssociationSortParam=function(t,e){return-1!==e.indexOf("-")&&(e=e.replace("-",""),t="-"+t),t+"."+e},qr.prototype._sortParam=function(t){if(t&&0<Object.keys(t).length){var e=[];for(var r in t)t.hasOwnProperty(r)&&("asc"!==t[r]&&(r="-"+r),e.push(r));return e}},qr.prototype._fetch=function(i){return o(this,void 0,void 0,function(){var e,r;return l(this,function(t){switch(t.label){case 0:return(e=this.toQueryParams())&&(i=i+"?"+e),[4,new f(this.model.middlewareStack,this.model.logger).get(i,this.fetchOptions())];case 1:return r=t.sent(),a(this.model,r),[2,r.jsonPayload]}})})},qr.prototype._buildRecordResult=function(t){var e,r;if(t.data instanceof Array){if(!(r=t.data[0]))return new Hr(t)}else r=t.data;return e=this.model.fromJsonapi(r,t),new Kr(e,t)},qr.prototype._buildCollectionResult=function(e){var r=this,i=[];return e.data.forEach(function(t){i.push(r.model.fromJsonapi(t,e))}),new Br(i,e)},qr.prototype._serverCasedWhereClause=function(t){return this._serverCasedClause(t,!1)},qr.prototype._serverCasedOrderClause=function(t){return"string"==typeof t?this._serverCasedClause(t,!0):this._serverCasedClause(t,!1)},qr.prototype._serverCasedFieldsClause=function(t){return this._serverCasedClause(t,!0)},qr.prototype._serverCasedIncludesClause=function(t){return this._serverCasedClause(t,!0)},qr.prototype._serverCasedStatsClause=function(t){return this._serverCasedClause(t,!0)},qr.prototype._serverCasedClause=function(t,e){var r=this;if(void 0===e&&(e=!1),"string"==typeof t)return e?this.model.serializeKey(t):t;if(t instanceof Array)return t.map(function(t){return r._serverCasedClause(t,e)});if(t instanceof Object){var i,n,s={};for(var o in t){t.hasOwnProperty(o)&&(i=this.model.serializeKey(o),n=this._serverCasedClause(t[o],e),s[i]=n)}return s}return t},qr);function qr(t){this._associations={},this._pagination={},this._filter={},this._sort={},this._fields={},this._extra_fields={},this._include={},this._stats={},this._extraParams={},this._extraFetchOptions={},this.model=t}var Vr=(Qr.prototype.register=function(t,e){if(this._typeMap[t])throw new Error('Type "'+t+'" already registered on base class '+this._baseClass);this._typeMap[t]=e},Qr.prototype.get=function(t){return this._typeMap[t]},Qr);function Qr(t){this._typeMap={},this._baseClass=t}var Yr=Object.prototype.toString;var Xr=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},ti=function(t,e,r){return e&&ei(t.prototype,e),r&&ei(t,r),t};function ei(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function ri(t){return t.split("").map(function(t){return"(?:"+t.toUpperCase()+"|"+t.toLowerCase()+")"}).join("")}function ii(t,e){for(var r=t.length-1;0<=r;r--)t[r]===e&&Array.prototype.splice.call(t,r,1)}var ni={},si=(ti(oi,null,[{key:"getInstance",value:function(t){return ni[t]=ni[t]||new oi,ni[t]}}]),ti(oi,[{key:"acronym",value:function(t){this.acronyms[t.toLowerCase()]=t;var e,r,i=[];for(var n in this.acronyms)e=this.acronyms,r=n,Object.prototype.hasOwnProperty.call(e,r)&&i.push(this.acronyms[n]);this.acronymRegex=new RegExp(i.join("|"))}},{key:"plural",value:function(t,e){"string"==typeof t&&ii(this.uncountables,t),ii(this.uncountables,e),this.plurals.unshift([t,e])}},{key:"singular",value:function(t,e){"string"==typeof t&&ii(this.uncountables,t),ii(this.uncountables,e),this.singulars.unshift([t,e])}},{key:"irregular",value:function(t,e){ii(this.uncountables,t),ii(this.uncountables,e);var r,i,n=t[0],s=t.substr(1),o=e[0],a=e.substr(1);n.toUpperCase()===o.toUpperCase()?(this.plural(new RegExp("("+n+")"+s+"$","i"),"$1"+a),this.plural(new RegExp("("+o+")"+a+"$","i"),"$1"+a),this.singular(new RegExp("("+n+")"+s+"$","i"),"$1"+s),this.singular(new RegExp("("+o+")"+a+"$","i"),"$1"+s)):(r=ri(s),i=ri(a),this.plural(new RegExp(n.toUpperCase()+r+"$"),o.toUpperCase()+a),this.plural(new RegExp(n.toLowerCase()+r+"$"),o.toLowerCase()+a),this.plural(new RegExp(o.toUpperCase()+i+"$"),o.toUpperCase()+a),this.plural(new RegExp(o.toLowerCase()+i+"$"),o.toLowerCase()+a),this.singular(new RegExp(n.toUpperCase()+r+"$"),n.toUpperCase()+s),this.singular(new RegExp(n.toLowerCase()+r+"$"),n.toLowerCase()+s),this.singular(new RegExp(o.toUpperCase()+i+"$"),n.toUpperCase()+s),this.singular(new RegExp(o.toLowerCase()+i+"$"),n.toLowerCase()+s))}},{key:"uncountable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.uncountables=this.uncountables.concat(e)}},{key:"human",value:function(t,e){this.humans.unshift([t,e])}},{key:"clear",value:function(t){var e=0<arguments.length&&void 0!==t?t:"all";"all"===e?(this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[]):this[e]=[]}}]),oi);function oi(){Xr(this,oi),this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[],this.acronyms={},this.acronymRegex=/(?=a)b/}var ai={en:function(t){t.plural(/$/,"s"),t.plural(/s$/i,"s"),t.plural(/^(ax|test)is$/i,"$1es"),t.plural(/(octop|vir)us$/i,"$1i"),t.plural(/(octop|vir)i$/i,"$1i"),t.plural(/(alias|status)$/i,"$1es"),t.plural(/(bu)s$/i,"$1ses"),t.plural(/(buffal|tomat)o$/i,"$1oes"),t.plural(/([ti])um$/i,"$1a"),t.plural(/([ti])a$/i,"$1a"),t.plural(/sis$/i,"ses"),t.plural(/(?:([^f])fe|([lr])f)$/i,"$1$2ves"),t.plural(/(hive)$/i,"$1s"),t.plural(/([^aeiouy]|qu)y$/i,"$1ies"),t.plural(/(x|ch|ss|sh)$/i,"$1es"),t.plural(/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"),t.plural(/^(m|l)ouse$/i,"$1ice"),t.plural(/^(m|l)ice$/i,"$1ice"),t.plural(/^(ox)$/i,"$1en"),t.plural(/^(oxen)$/i,"$1"),t.plural(/(quiz)$/i,"$1zes"),t.singular(/s$/i,""),t.singular(/(ss)$/i,"$1"),t.singular(/(n)ews$/i,"$1ews"),t.singular(/([ti])a$/i,"$1um"),t.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1sis"),t.singular(/(^analy)(sis|ses)$/i,"$1sis"),t.singular(/([^f])ves$/i,"$1fe"),t.singular(/(hive)s$/i,"$1"),t.singular(/(tive)s$/i,"$1"),t.singular(/([lr])ves$/i,"$1f"),t.singular(/([^aeiouy]|qu)ies$/i,"$1y"),t.singular(/(s)eries$/i,"$1eries"),t.singular(/(m)ovies$/i,"$1ovie"),t.singular(/(x|ch|ss|sh)es$/i,"$1"),t.singular(/^(m|l)ice$/i,"$1ouse"),t.singular(/(bus)(es)?$/i,"$1"),t.singular(/(o)es$/i,"$1"),t.singular(/(shoe)s$/i,"$1"),t.singular(/(cris|test)(is|es)$/i,"$1is"),t.singular(/^(a)x[ie]s$/i,"$1xis"),t.singular(/(octop|vir)(us|i)$/i,"$1us"),t.singular(/(alias|status)(es)?$/i,"$1"),t.singular(/^(ox)en/i,"$1"),t.singular(/(vert|ind)ices$/i,"$1ex"),t.singular(/(matr)ices$/i,"$1ix"),t.singular(/(quiz)zes$/i,"$1"),t.singular(/(database)s$/i,"$1"),t.irregular("person","people"),t.irregular("man","men"),t.irregular("child","children"),t.irregular("sex","sexes"),t.irregular("move","moves"),t.irregular("zombie","zombies"),t.uncountable("equipment","information","rice","money","species","series","fish","sheep","jeans","police")}};function ui(t,e){var r;if(r=t,"[object Function]"===Yr.call(r)&&(e=t,t=null),t=t||"en",!e)return si.getInstance(t);e(si.getInstance(t))}for(var ci in ai)ui(ci,ai[ci]);function li(t,e){return function(t,e){var r,i,n,s=""+t;if(0===s.length)return s;var o=s.toLowerCase().match(/\b\w+$/);if(o&&-1<ui().uncountables.indexOf(o[0]))return s;for(var a=0,u=e.length;a<u;a++)if(i=(r=e[a])[0],n=r[1],s.match(i)){s=s.replace(i,n);break}return s}(t,ui(1<arguments.length&&void 0!==e?e:"en").plurals)}function pi(t){var e=null==t?"":String(t);return e.charAt(0).toUpperCase()+e.slice(1)}function hi(t,e){null==e&&(e=!0);var r=""+t;return r=(r=e?r.replace(/^[a-z\d]*/,function(t){return ui().acronyms[t]||pi(t)}):r.replace(new RegExp("^(?:"+ui().acronymRegex.source+"(?=\\b|[A-Z_])|\\w)"),function(t){return t.toLowerCase()})).replace(/(?:_|(\/))([a-z\d]*)/gi,function(t,e,r,i,n){return""+(e=e||"")+(ui().acronyms[r]||pi(r))})}function fi(t){var e=""+t;return(e=(e=(e=(e=e.replace(new RegExp("(?:([A-Za-z\\d])|^)("+ui().acronymRegex.source+")(?=\\b|[^a-z])","g"),function(t,e,r){return(e||"")+(e?"_":"")+r.toLowerCase()})).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2")).replace(/([a-z\d])([A-Z])/g,"$1_$2")).replace(/-/g,"_")).toLowerCase()}function di(t){return t.replace(/_/g,"-")}var yi,vi,bi={"Ã€":"A","Ã":"A","Ã‚":"A","Ãƒ":"A","Ã„":"A","Ã…":"A","Ã†":"AE","Ã‡":"C","Ãˆ":"E","Ã‰":"E","ÃŠ":"E","Ã‹":"E","ÃŒ":"I","Ã":"I","ÃŽ":"I","Ã":"I","Ã":"D","Ã‘":"N","Ã’":"O","Ã“":"O","Ã”":"O","Ã•":"O","Ã–":"O","Ã—":"x","Ã˜":"O","Ã™":"U","Ãš":"U","Ã›":"U","Ãœ":"U","Ã":"Y","Ãž":"Th","ÃŸ":"ss","Ã ":"a","Ã¡":"a","Ã¢":"a","Ã£":"a","Ã¤":"a","Ã¥":"a","Ã¦":"ae","Ã§":"c","Ã¨":"e","Ã©":"e","Ãª":"e","Ã«":"e","Ã¬":"i","Ã­":"i","Ã®":"i","Ã¯":"i","Ã°":"d","Ã±":"n","Ã²":"o","Ã³":"o","Ã´":"o","Ãµ":"o","Ã¶":"o","Ã¸":"o","Ã¹":"u","Ãº":"u","Ã»":"u","Ã¼":"u","Ã½":"y","Ã¾":"th","Ã¿":"y","Ä€":"A","Ä":"a","Ä‚":"A","Äƒ":"a","Ä„":"A","Ä…":"a","Ä†":"C","Ä‡":"c","Äˆ":"C","Ä‰":"c","ÄŠ":"C","Ä‹":"c","ÄŒ":"C","Ä":"c","ÄŽ":"D","Ä":"d","Ä":"D","Ä‘":"d","Ä’":"E","Ä“":"e","Ä”":"E","Ä•":"e","Ä–":"E","Ä—":"e","Ä˜":"E","Ä™":"e","Äš":"E","Ä›":"e","Äœ":"G","Ä":"g","Äž":"G","ÄŸ":"g","Ä ":"G","Ä¡":"g","Ä¢":"G","Ä£":"g","Ä¤":"H","Ä¥":"h","Ä¦":"H","Ä§":"h","Ä¨":"I","Ä©":"i","Äª":"I","Ä«":"i","Ä¬":"I","Ä­":"i","Ä®":"I","Ä¯":"i","Ä°":"I","Ä±":"i","Ä²":"IJ","Ä³":"ij","Ä´":"J","Äµ":"j","Ä¶":"K","Ä·":"k","Ä¸":"k","Ä¹":"L","Äº":"l","Ä»":"L","Ä¼":"l","Ä½":"L","Ä¾":"l","Ä¿":"L","Å€":"l","Å":"L","Å‚":"l","Åƒ":"N","Å„":"n","Å…":"N","Å†":"n","Å‡":"N","Åˆ":"n","Å‰":"'n","ÅŠ":"NG","Å‹":"ng","ÅŒ":"O","Å":"o","ÅŽ":"O","Å":"o","Å":"O","Å‘":"o","Å’":"OE","Å“":"oe","Å”":"R","Å•":"r","Å–":"R","Å—":"r","Å˜":"R","Å™":"r","Åš":"S","Å›":"s","Åœ":"S","Å":"s","Åž":"S","ÅŸ":"s","Å ":"S","Å¡":"s","Å¢":"T","Å£":"t","Å¤":"T","Å¥":"t","Å¦":"T","Å§":"t","Å¨":"U","Å©":"u","Åª":"U","Å«":"u","Å¬":"U","Å­":"u","Å®":"U","Å¯":"u","Å°":"U","Å±":"u","Å²":"U","Å³":"u","Å´":"W","Åµ":"w","Å¶":"Y","Å·":"y","Å¸":"Y","Å¹":"Z","Åº":"z","Å»":"Z","Å¼":"z","Å½":"Z","Å¾":"z","Ð":"A","Ð‘":"B","Ð’":"V","Ð“":"G","Ð”":"D","Ð•":"E","Ð":"E","Ð–":"ZH","Ð—":"Z","Ð˜":"I","Ð™":"J","Ðš":"K","Ð›":"L","Ðœ":"M","Ð":"N","Ðž":"O","ÐŸ":"P","Ð ":"R","Ð¡":"S","Ð¢":"T","Ð£":"U","Ð¤":"F","Ð¥":"KH","Ð¦":"C","Ð§":"CH","Ð¨":"SH","Ð©":"SHCH","Ðª":"","Ð«":"Y","Ð¬":"","Ð­":"E","Ð®":"YU","Ð¯":"YA","Ð°":"a","Ð±":"b","Ð²":"v","Ð³":"g","Ð´":"d","Ðµ":"e","Ñ‘":"e","Ð¶":"zh","Ð·":"z","Ð¸":"i","Ð¹":"j","Ðº":"k","Ð»":"l","Ð¼":"m","Ð½":"n","Ð¾":"o","Ð¿":"p","Ñ€":"r","Ñ":"s","Ñ‚":"t","Ñƒ":"u","Ñ„":"f","Ñ…":"kh","Ñ†":"c","Ñ‡":"ch","Ñˆ":"sh","Ñ‰":"shch","ÑŠ":"","Ñ‹":"y","ÑŒ":"","Ñ":"e","ÑŽ":"yu","Ñ":"ya"},gi={};ti(_i,null,[{key:"getInstance",value:function(t){return gi[t]=gi[t]||new _i,gi[t]}}]),ti(_i,[{key:"approximate",value:function(t,e){this.approximations[t]=e}},{key:"transliterate",value:function(t,e){var r=this;return t.replace(/[^\u0000-\u007f]/g,function(t){return r.approximations[t]||e||"?"})}}]);function _i(){for(var t in Xr(this,_i),this.approximations={},bi)this.approximate(t,bi[t])}(vi=yi=yi||{})[vi.debug=1]="debug",vi[vi.info=2]="info",vi[vi.warn=3]="warn",vi[vi.error=4]="error";var mi={debug:1,info:2,warn:3,error:4};function ji(t){void 0===t&&(t="warn"),this._level=yi.info,"number"==typeof t?this._level=t:this.level=t}var wi=new(ji.prototype.debug=function(t){this._level<=yi.debug&&console.info(t)},ji.prototype.info=function(t){this._level<=yi.info&&console.info(t)},ji.prototype.warn=function(t){this._level<=yi.warn&&console.warn(t)},ji.prototype.error=function(t){this._level<=yi.warn&&console.error(t)},Object.defineProperty(ji.prototype,"level",{get:function(){var t;for(t in yi){if(yi.hasOwnProperty(t))if(yi[t]===this._level)return t}throw new Error("Invalid log level: "+this._level)},set:function(t){var e=yi[t];if(!e)throw new Error("Log level must be one of "+Object.keys(mi).join(", "));this._level=e},enumerable:!0,configurable:!0}),ji);function ki(r,i){return o(this,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:e=0,t.label=1;case 1:return e<r.length?[4,i(r[e],e,r)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e+=1,[3,1];case 4:return[2]}})})}var Oi=(Object.defineProperty(Ai.prototype,"beforeFilters",{get:function(){return this._beforeFilters},enumerable:!0,configurable:!0}),Object.defineProperty(Ai.prototype,"afterFilters",{get:function(){return this._afterFilters},enumerable:!0,configurable:!0}),Ai.prototype.beforeFetch=function(i,n){return o(this,void 0,void 0,function(){var r=this;return l(this,function(t){switch(t.label){case 0:return[4,ki(this._beforeFilters,function(e){return o(r,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,e(i,n)];case 1:return t.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},Ai.prototype.afterFetch=function(i,n){return o(this,void 0,void 0,function(){var r=this;return l(this,function(t){switch(t.label){case 0:return[4,ki(this._afterFilters,function(e){return o(r,void 0,void 0,function(){return l(this,function(t){switch(t.label){case 0:return[4,e(i,n)];case 1:return t.sent(),[2]}})})})];case 1:return t.sent(),[2]}})})},Ai);function Ai(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this._beforeFilters=[],this._afterFilters=[],this._beforeFilters=t,this._afterFilters=e}function Pi(t,e){Object.defineProperty(t,e,{get:function(){},set:function(t){Object.defineProperty(this,e,{value:t,writable:!0,configurable:!0,enumerable:!1})},configurable:!0,enumerable:!1})}function Ci(t,e){var r;for(r in(e=n({},e)).credentialStorageBackend&&(t.credentialStorageBackend=e.credentialStorageBackend,delete e.jwtStorage),e.jwtStorage&&(t.jwtStorage=e.jwtStorage,delete e.jwtStorage),e.jwt&&(t.setJWT(e.jwt),delete e.jwt),e)e.hasOwnProperty(r)&&(t[r]=e[r]);void 0===t.isBaseClass?t.setAsBase():!0===t.isBaseClass&&(t.isBaseClass=!1)}var Si=(Object.defineProperty($i,"credentialStorage",{get:function(){return this._credentialStorage},enumerable:!0,configurable:!0}),Object.defineProperty($i,"jwtStorage",{get:function(){return this._jwtStorage},set:function(t){t!==this._jwtStorage&&(this._jwtStorage=t,this.credentialStorageBackend=this._credentialStorageBackend)},enumerable:!0,configurable:!0}),Object.defineProperty($i,"credentialStorageBackend",{get:function(){return this._credentialStorageBackend},set:function(t){this._credentialStorageBackend=t,this._credentialStorage=new R(this.jwtStorage||"jwt",this._credentialStorageBackend)},enumerable:!0,configurable:!0}),$i.initializeCredentialStorage=function(){this.jwtStorage&&"undefined"!=typeof localStorage?this.credentialStorageBackend=localStorage:this.credentialStorageBackend=new S},$i.fromJsonapi=function(t,e){return r=this.typeRegistry,i=t,new Dr(r,e).deserialize(i);var r,i},$i.inherited=function(t){t.parentClass=this,((t.currentClass=t).prototype.klass=t).attributeList=$r(t.attributeList),t.linkList=$r(t.linkList)},$i.setAsBase=function(){this.isBaseClass=!0,this.jsonapiType=void 0,this.typeRegistry||(this.typeRegistry=new Vr(this)),this.middlewareStack||(this._middlewareStack=new Oi),this._IDMap||(this._IDMap=new Fr)},$i.isSubclassOf=function(t){for(var e=this.currentClass;e;){if(e===t)return!0;e=e.parentClass}return!1},Object.defineProperty($i,"baseClass",{get:function(){for(var t=this.currentClass;t;){if(t.isBaseClass)return t;t=t.parentClass}},enumerable:!0,configurable:!0}),Object.defineProperty($i,"store",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._IDMap},enumerable:!0,configurable:!0}),Object.defineProperty($i,"typeRegistry",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._typeRegistry},set:function(t){if(!this.isBaseClass)throw new Error("Cannot set a registry on a non-base class");this._typeRegistry=t},enumerable:!0,configurable:!0}),$i.registerType=function(){var t;this.jsonapiType&&((t=this.typeRegistry.get(this.jsonapiType))&&this.isSubclassOf(t)||this.typeRegistry.register(this.jsonapiType,this))},$i.extend=function(t){var e,r=(u(i,e=this),i);function i(){return null!==e&&e.apply(this,arguments)||this}this.inherited(r);var n,s={};if(t.attrs)for(var o in t.attrs){t.attrs.hasOwnProperty(o)&&((n=t.attrs[o]).name||(n.name=o),n.owner=r,s[o]=n)}if(r.attributeList=Object.assign({},r.attributeList,s),r.linkList=r.linkList.slice(),Ci(r,t.static||{}),r.registerType(),t.methods)for(var a in t.methods)t.methods.hasOwnProperty(a)&&(r.prototype[a]=t.methods[a]);return r},$i.prototype._initializeAttributes=function(){this._attributes={},this._copyPrototypeDescriptors()},$i.prototype._initializeLinks=function(){this._links={}},$i.prototype._copyPrototypeDescriptors=function(){var t,r=this,e=this.klass.attributeList;for(var i in e){e.hasOwnProperty(i)&&(t=e[i],Object.defineProperty(this,i,t.descriptor()))}["errors","isPersisted","isMarkedForDestruction","isMarkedForDisassociation"].forEach(function(t){var e=Object.getOwnPropertyDescriptor($i.prototype,t);e&&Object.defineProperty(r,t,e)})},$i.prototype.isType=function(t){return this.klass.jsonapiType===t},Object.defineProperty($i.prototype,"isPersisted",{get:function(){return this._persisted},set:function(t){(this._persisted=t)&&this.reset()},enumerable:!0,configurable:!0}),$i.prototype.onSyncRelationships=function(){var r=this;return this._onSyncRelationships||(this._onSyncRelationships=function(t,e){r.relationships=e}),this._onSyncRelationships},$i.prototype.onStoreChange=function(){var s=this;return this._onStoreChange||(this._onStoreChange=function(t,i){var n={};Object.keys(i).forEach(function(t){var e=s,r=s.changes();s.klass.attributeList[t].dirtyChecker(e[t],i[t])&&!r[t]&&(n[t]=[e[t],i[t]],e[t]=i[t],e._originalAttributes[t]=i[t])}),0<Object.keys(n).length&&void 0!==s.afterSync&&s.afterSync(n)}),this._onStoreChange},$i.prototype.unlisten=function(){var r=this;this.klass.sync&&(this.storeKey&&(xr.removeEventListener(this.storeKey,this.onStoreChange()),xr.removeEventListener(this.storeKey+"-sync-relationships",this.onSyncRelationships())),Object.keys(this.relationships).forEach(function(t){var e=r.relationships[t];e&&(Array.isArray(e)?e.forEach(function(t){return t.unlisten()}):e.unlisten())}))},$i.prototype.listen=function(){this.klass.sync&&(this._onStoreChange||(xr.addEventListener(this.storeKey,this.onStoreChange()),xr.addEventListener(this.storeKey+"-sync-relationships",this.onSyncRelationships())))},$i.prototype.syncRelationships=function(){xr.dispatch(this.storeKey+"-sync-relationships",{},this.relationships)},$i.prototype.reset=function(){this.klass.sync&&(this.klass.store.updateOrCreate(this),this.listen()),this._originalAttributes=$r(this._attributes),this.relationships&&(this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships)))},$i.prototype.rollback=function(){this._attributes=$r(this._originalAttributes)},Object.defineProperty($i.prototype,"isMarkedForDestruction",{get:function(){return this._markedForDestruction},set:function(t){this._markedForDestruction=t},enumerable:!0,configurable:!0}),Object.defineProperty($i.prototype,"isMarkedForDisassociation",{get:function(){return this._markedForDisassociation},set:function(t){this._markedForDisassociation=t},enumerable:!0,configurable:!0}),Object.defineProperty($i.prototype,"attributes",{get:function(){return this._attributes},set:function(t){this._attributes={},this.assignAttributes(t)},enumerable:!0,configurable:!0}),Object.defineProperty($i.prototype,"stored",{get:function(){return this.klass.store.find(this)},enumerable:!0,configurable:!0}),Object.defineProperty($i.prototype,"typedAttributes",{get:function(){return this._attributes},enumerable:!0,configurable:!0}),$i.prototype.relationship=function(t){return this.relationships[t]},$i.prototype.assignAttributes=function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){var r=this.klass.deserializeKey(e);if("id"===e||this.klass.attributeList[r])this[r]=t[e];else if(this.klass.strictAttributes)throw new Error("Unknown attribute: "+e)}},$i.prototype.setMeta=function(t){this.__meta__=t},$i.prototype.relationshipResourceIdentifiers=function(t){return r=this,i={},t.forEach(function(e){var t=r.relationship(e);t&&(Array.isArray(t)||(t=[t]),t.forEach(function(t){t.isPersisted&&(i[e]||(i[e]=[]),i[e].push(t.resourceIdentifier))}))}),i;var r,i},$i.prototype.fromJsonapi=function(t,e,r){return void 0===r&&(r={}),n=t,s=e,void 0===(o=r)&&(o={}),new Dr((i=this).klass.typeRegistry,s).deserializeInstance(i,n,o);var i,n,s,o},Object.defineProperty($i.prototype,"resourceIdentifier",{get:function(){if(void 0===this.klass.jsonapiType)throw new Error("Cannot build resource identifier for class. No JSONAPI Type specified.");return{id:this.id,type:this.klass.jsonapiType}},enumerable:!0,configurable:!0}),Object.defineProperty($i.prototype,"errors",{get:function(){return this._errors},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),Object.defineProperty($i.prototype,"hasError",{get:function(){return 1<Object.keys(this._errors).length},enumerable:!0,configurable:!0}),$i.prototype.clearErrors=function(){this.errors={}},$i.prototype.isDirty=function(t){return new Lr(this).check(t)},$i.prototype.changes=function(){return new Lr(this).dirtyAttributes()},$i.prototype.hasDirtyRelation=function(t,e){var r=new Lr(this);return!this.isPersisted||r.checkRelation(t,e)},$i.prototype.dup=function(){var t=Object.assign({},this.attributes,this.relationships),e=new this.klass(t);return e.id=this.id,e.isPersisted=this.isPersisted,e.isMarkedForDestruction=this.isMarkedForDestruction,e.isMarkedForDisassociation=this.isMarkedForDisassociation,e.errors=Object.assign({},this.errors),e.links=Object.assign({},this.links),e},$i.fetchOptions=function(){var t,e={credentials:"same-origin",headers:((t={Accept:"application/vnd.api+json"})["Content-Type"]="application/vnd.api+json",t)};this.clientApplication&&(e.headers["Client-Application"]=this.clientApplication);var r=this.getJWT();return r&&(e.headers.Authorization=this.generateAuthHeader(r)),e},$i.url=function(t){var e=this.endpoint||"/"+this.jsonapiType,r=""+this.fullBasePath()+e;return t&&(r=r+"/"+t),r},$i.fullBasePath=function(){return""+this.baseUrl+this.apiNamespace},Object.defineProperty($i,"middlewareStack",{get:function(){if(this.baseClass){var t=this.baseClass._middlewareStack;if(this.beforeFetch||this.afterFetch){var e=this.beforeFetch?[this.beforeFetch]:t.beforeFilters,r=this.afterFetch?[this.afterFetch]:t.afterFilters;return new Oi(e,r)}return t}return new Oi},set:function(t){this._middlewareStack=t},enumerable:!0,configurable:!0}),$i.scope=function(){return new Zr(this)},$i.first=function(){return this.scope().first()},$i.all=function(){return this.scope().all()},$i.find=function(t){return this.scope().find(t)},$i.where=function(t){return this.scope().where(t)},$i.page=function(t){return this.scope().page(t)},$i.per=function(t){return this.scope().per(t)},$i.extraParams=function(t){return this.scope().extraParams(t)},$i.extraFetchOptions=function(t){return this.scope().extraFetchOptions(t)},$i.order=function(t){return this.scope().order(t)},$i.select=function(t){return this.scope().select(t)},$i.selectExtra=function(t){return this.scope().selectExtra(t)},$i.stats=function(t){return this.scope().stats(t)},$i.includes=function(t){return this.scope().includes(t)},$i.merge=function(t){return this.scope().merge(t)},$i.setJWT=function(t){this.credentialStorage.setJWT(t)},$i.getJWT=function(){return this.credentialStorage.getJWT()},Object.defineProperty($i,"jwt",{get:function(){return this.getJWT()},set:function(t){this.setJWT(t)},enumerable:!0,configurable:!0}),$i.generateAuthHeader=function(t){return'Token token="'+t+'"'},$i.getJWTOwner=function(){return this.logger.warn("SpraypaintBase#getJWTOwner() is deprecated. Use #baseClass property instead"),this.baseClass},$i.serializeKey=function(t){switch(this.keyCase.server){case"dash":return di(fi(t));case"snake":return fi(t);case"camel":return hi(fi(t),!1)}},$i.deserializeKey=function(t){switch(this.keyCase.client){case"dash":return di(fi(t));case"snake":return fi(t);case"camel":return hi(fi(t),!1)}},$i.prototype.destroy=function(){return o(this,void 0,void 0,function(){var e,r,i,n=this;return l(this,function(t){switch(t.label){case 0:e=this.klass.url(this.id),r=new f(this._middleware(),this.klass.logger),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.delete(e,this._fetchOptions())];case 2:return i=t.sent(),[3,4];case 3:throw t.sent();case 4:return 202!==i.status?[3,6]:[4,this._handleAcceptedResponse(i,this.onDeferredDestroy)];case 5:return[2,t.sent()];case 6:return this.klass.baseClass.store.destroy(this),[4,this._handleResponse(i,function(){n.isPersisted=!1})];case 7:return[2,t.sent()]}})})},$i.prototype.save=function(c){return void 0===c&&(c={}),o(this,void 0,void 0,function(){var e,r,i,n,s,o,a,u=this;return l(this,function(t){switch(t.label){case 0:if(e=this.klass.url(),r="post",i=new f(this._middleware(),this.klass.logger,{patchAsPost:this.klass.patchAsPost}),n=new A(this,c.with),this.isPersisted&&(e=this.klass.url(this.id),r="patch"),c.returnScope){if((o=c.returnScope).model!==this.klass)throw new Error("returnScope must be a scope of type Scope<"+this.klass.name+">");e=e+"?"+o.toQueryParams()}this.clearErrors(),a=n.asJSON(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,i[r](e,a,this._fetchOptions())];case 2:return s=t.sent(),[3,4];case 3:throw t.sent();case 4:return 202!==s.status&&204!==s.status?[3,6]:[4,this._handleAcceptedResponse(s,this.onDeferredUpdate)];case 5:return[2,t.sent()];case 6:return[4,this._handleResponse(s,function(){u.fromJsonapi(s.jsonPayload.data,s.jsonPayload,n.includeDirective),n.postProcess()})];case 7:return[2,t.sent()]}})})},$i.prototype._handleAcceptedResponse=function(r,i){return o(this,void 0,void 0,function(){var e;return l(this,function(t){switch(t.label){case 0:return r.jsonPayload&&i&&(e=this.klass.fromJsonapi(r.jsonPayload.data,r.jsonPayload),i(e)),[4,this._handleResponse(r,function(){})];case 1:return[2,t.sent()]}})})},$i.prototype._handleResponse=function(e,r){return o(this,void 0,void 0,function(){return l(this,function(t){if(a(this.klass,e),422!==e.status)return r(),[2,!0];try{s.apply(this,e.jsonPayload)}catch(t){throw new _(e,"validation failed",t)}return[2,!1]})})},$i.prototype._fetchOptions=function(){return this.klass.fetchOptions()},$i.prototype._middleware=function(){return this.klass.middlewareStack},$i.prototype.resetRelationTracking=function(t){this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(t))},Object.defineProperty($i.prototype,"links",{get:function(){return this._links},set:function(t){this._links={},this.assignLinks(t)},enumerable:!0,configurable:!0}),$i.prototype.assignLinks=function(t){if(t)for(var e in t){var r=this.klass.deserializeKey(e);-1<this.klass.linkList.indexOf(r)&&(this._links[r]=t[e])}},$i.baseUrl="http://please-set-a-base-url.com",$i.apiNamespace="/",$i.keyCase={server:"snake",client:"camel"},$i.strictAttributes=!1,$i.logger=wi,$i.sync=!1,$i.clientApplication=null,$i.patchAsPost=!1,$i.attributeList={},$i.linkList=[],($i.currentClass=$i)._jwtStorage="jwt",$i.isSpraypaintModel=!0,e([Pi],$i.prototype,"afterSync",void 0),e([Pi],$i.prototype,"relationships",void 0),e([Pi],$i.prototype,"klass",void 0),e([Pi],$i.prototype,"_persisted",void 0),e([Pi],$i.prototype,"_markedForDestruction",void 0),e([Pi],$i.prototype,"_markedForDisassociation",void 0),e([Pi],$i.prototype,"_originalRelationships",void 0),e([Pi],$i.prototype,"_attributes",void 0),e([Pi],$i.prototype,"_originalAttributes",void 0),e([Pi],$i.prototype,"_links",void 0),e([Pi],$i.prototype,"_originalLinks",void 0),e([Pi],$i.prototype,"__meta__",void 0),e([Pi],$i.prototype,"_errors",void 0),$i);function $i(t){this.stale=!1,this.storeKey="",this.relationships={},this._persisted=!1,this._markedForDestruction=!1,this._markedForDisassociation=!1,this._originalRelationships={},this._errors={},this._initializeAttributes(),this._initializeLinks(),this.assignAttributes(t),this._originalAttributes=$r(this._attributes),this._originalLinks=$r(this._links),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))}(Si.prototype.klass=Si).initializeCredentialStorage();function Ri(t){return!!t&&(t.currentClass&&t.currentClass.isSpraypaintModel)}function Ei(t,e){return t!==e}var xi=(Fi.prototype.apply=function(t){Object.defineProperty(t.prototype,this.name,this.descriptor())},Fi.prototype.setter=function(t,e){t._attributes[this.name]=e},Fi.prototype.getter=function(t){return t.attributes[this.name]},Fi.prototype.descriptor=function(){var e=this;return{configurable:!0,enumerable:!0,get:function(){return e.getter(this)},set:function(t){e.setter(this,t)}}},Fi);function Fi(t){this.isRelationship=!1,this.type=void 0,this.persist=!0,this.dirtyChecker=Ei,t&&(t.name&&(this.name=t.name),t.type&&(this.type=t.type),void 0!==t.persist&&(this.persist=!!t.persist),t.dirtyChecker&&(this.dirtyChecker=t.dirtyChecker))}function Ti(t){return!!t.klass.sync&&((t.isPersisted||t.stale)&&!t.stored)}var Di,zi=(u(Ii,Di=xi),Object.defineProperty(Ii.prototype,"klass",{get:function(){return this._klass||(this._klass=Zi(this,this.jsonapiType)),this._klass},enumerable:!0,configurable:!0}),Ii.prototype.getter=function(t){var e=t.relationships[this.name];return e&&Ti(e)&&delete t.relationships[this.name],t.relationships[this.name]},Ii.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof Si||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},Ii);function Ii(t){var e=Di.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}var Li,Mi=(u(Ui,Li=xi),Object.defineProperty(Ui.prototype,"klass",{get:function(){return this._klass||(this._klass=Zi(this,this.jsonapiType)),this._klass},enumerable:!0,configurable:!0}),Ui.prototype.getter=function(t){var e=t.relationships[this.name];if(!e)return this.setter(t,[]),t.relationships[this.name];for(var r=e.length;r--;){Ti(e[r])&&(t.relationships[this.name],e.splice(r,1))}return t.relationships[this.name]},Ui.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof Si||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},Ui);function Ui(t){var e=Li.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}var Ni,Bi=(u(Ji,Ni=zi),Ji);function Ji(){return null!==Ni&&Ni.apply(this,arguments)||this}var Ki,Wi=(u(Hi,Ki=zi),Hi);function Hi(){return null!==Ki&&Ki.apply(this,arguments)||this}var Gi=function(t){var e={};return void 0!==t&&("string"==typeof t?e={jsonapiType:t}:(e={persist:t.persist,name:t.name},"string"==typeof t.type?e.jsonapiType=t.type:e.type=t.type)),e},Zi=function(t,e){var r=t.owner.typeRegistry.get(e);if(r)return r;throw new Error('Unknown type "'+e+'"')},qi="undefined"!=typeof window,Vi=!("production"===process.env.NODE_ENV);function Qi(t){return t&&void 0!==t.kind}function Yi(u){return function(r,t,o){function i(t,e){var r;void 0===o?(r=li(fi(e)),a={jsonapiType:r}):"string"==typeof o?a={jsonapiType:o}:Ri(o)?a={type:o}:(a={persist:o.persist,name:o.name},"string"==typeof o.type?a.jsonapiType=o.type:a.type=o.type);var i=new u(a);i.name||(i.name=e);var n,s=(n=t.constructor,tn(n),n);return(s.attributeList[e]=i).owner=t.constructor,i.apply(s),i.descriptor()}var a;if(Qi(r))return Object.assign(r,{finisher:function(t){i(t.prototype,r.key)}});if(!Ri(r)||!t){return function(e,t){return Qi(e)?Object.assign(e,{finisher:function(t){i(t.prototype,e.key)}}):(o=r,i(e,t))}}i(r.prototype,t)}}var Xi=function(t,e){tn(t),Ci(t,e||{}),t.jsonapiType||t.isBaseClass||(t.jsonapiType=li(fi(t.name)),Vi&&qi&&wi.warn('Inferring model jsonapiType as "'+t.jsonapiType+'".\nYou should explicitly set this on your model if targeting a minified code bundle.')),t.registerType()},tn=function(t){t.currentClass!==t&&t.currentClass.inherited(t)},en=Yi(Mi),rn=Yi(Bi),nn=Yi(Wi);t.SpraypaintBase=Si,t.Attribute=xi,t.attr=function(t){return new xi(t=t||{})},t.hasMany=function(t){var e=Gi(t);return new Mi(e)},t.hasOne=function(t){var e=Gi(t);return new Bi(e)},t.belongsTo=function(t){var e=Gi(t);return new Wi(e)},t.Model=function(e){return r=function(t){return Xi(t,e),t},function(t){return Qi(t)?Object.assign(t,{finisher:r}):r(t)};var r},t.Attr=function(e,t,r){function i(t,e){return tn(t),n.name||(n.name=e),(t.attributeList[e]=n).apply(t),n.descriptor()}var n=new xi({name:t});if(Qi(e))return Object.assign(e,{finisher:function(t){i(t,e.key)}});if(!(Ri(e)||(s=e)&&Ri(s.constructor.currentClass)))return e&&(n=new xi(e)),function(t,e){return i(t.constructor,e)};if(!t)throw new Error("Must provide a propertyKey");var s,o=e;if(!Ri(o))return i(o.constructor,t);r&&(n=new xi(r)),i(o,t)},t.HasMany=en,t.HasOne=rn,t.BelongsTo=nn,t.Link=function(e){function r(t,e){tn(t),t.linkList.push(e)}return Qi(e)?Object.assign(e,{finisher:function(t){r(t,e.key)}}):function(t,e){r(t.constructor,e)}},t.MiddlewareStack=Oi,t.Scope=Zr,Object.defineProperty(t,"__esModule",{value:!0})});
